!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("rudy-captcha",[],e):"object"==typeof exports?exports["rudy-captcha"]=e():t["rudy-captcha"]=e()}("undefined"!=typeof self?self:this,function(){return function(t){function e(r){if(o[r])return o[r].exports;var i=o[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,e),i.l=!0,i.exports}var o={};return e.m=t,e.c=o,e.d=function(t,o,r){e.o(t,o)||Object.defineProperty(t,o,{configurable:!1,enumerable:!0,get:r})},e.n=function(t){var o=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(o,"a",o),o},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="./dist/",e(e.s=0)}([function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=o(1),i=function(t){return t&&t.__esModule?t:{default:t}}(r);i.default.install=function(t){t.component(i.default.name,i.default)},"undefined"!=typeof window&&window.Vue&&i.default.install(window.Vue),e.default=i.default},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={name:"RudyCaptcha",props:{width:{type:Number,default:82},height:{type:Number,default:38},bgColor:{type:String,default:"#ffffff"},captchaCodes:{type:String,default:"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789"},colors:{type:Array,default:function(){return[]}},fontStyle:{type:String,default:"both"},fontFamily:{type:String,default:"微软雅黑"},fontSizeMin:{type:Number,default:12},fontSizeMax:{type:Number,default:38},codeLength:{type:Number,default:4},textFuzzy:{type:Number,default:3},lineColorMax:{type:Number,default:200},lineColorMin:{type:Number,default:30},lineColorOpacity:{type:Number,default:.2},lineFuzzy:{type:Number,default:3},lineWidth:{type:Number,default:5},lineNumber:{type:Number,default:0},dotColorMax:{type:Number,default:200},dotColorMin:{type:Number,default:30},dotColorOpacity:{type:Number,default:.2},dotFuzzy:{type:Number,default:10},dotNumber:{type:Number,default:0},dotR:{type:Number,default:10},cursor:{type:String,default:"pointer"},clickFresh:Boolean},data:function(){return{captchaCode:""}},render:function(t){return t("div",{style:{display:"inline-block","font-size":0}},[t("canvas",{ref:"rudyCaptcha",attrs:{width:this.width,height:this.height},on:{click:this.clickFresh&&this.updateCode},style:{backgroundColor:this.bgColor,cursor:this.clickFresh&&this.cursor}})])},mounted:function(){this.ctx=this.$refs.rudyCaptcha.getContext("2d"),this.updateCode()},methods:{updateCode:function(){this.refreshCode(),this.$refs.rudyCaptcha.width=this.width,this.$refs.rudyCaptcha.height=this.height,this.drawLine(),this.drawDot(),this.drawImg()},refreshCode:function(){this.captchaCode="";for(var t=0;t<this.codeLength;t++)this.captchaCode+=this.captchaCodes[this.randomNum(0,this.captchaCodes.length)]},randomNum:function(t,e){return Math.floor(Math.random()*(e-t)+t)},randomRgbColor:function(t,e){return"rgb("+this.randomNum(t,e)+","+this.randomNum(t,e)+","+this.randomNum(t,e)+")"},randomRgbaColor:function(t,e,o){return"rgb("+this.randomNum(t,e)+","+this.randomNum(t,e)+","+this.randomNum(t,e)+", "+o+")"},drawImg:function(){this.ctx.textAlign="center",this.ctx.textBaseline="middle",this.ctx.lineWidth=1;for(var t=0;t<this.codeLength;t++)this.drawText(this.captchaCode[t],t)},drawText:function(t,e){var o=this.ctx;o.shadowColor=this.calcColor(),o.shadowBlur=this.randomNum(0,this.textFuzzy),o.shadowOffsetY=2*this.height;var r=this.randomNum(this.fontSizeMin,this.fontSizeMax);o.font=r+"px "+this.fontFamily;var i=(e+1)*(this.width/(this.codeLength+1)),a=(this.height-r-6)/2,s=this.height/2-2*this.height;s+=this.randomNum(3-Math.abs(a),Math.abs(a)+3);var h=this.randomNum(-45,45);switch(o.translate(i,s),o.rotate(h*Math.PI/180),this.fontStyle){case"line":o.strokeText(t,0,0);break;case"solid":o.fillText(t,0,0);break;default:e%2?o.fillText(t,0,0):o.strokeText(t,0,0)}o.rotate(-h*Math.PI/180),o.translate(-i,-s)},calcColor:function(){var t=this.randomRgbColor(0,255),e=0;if(this.colors.length)e=2,t=this.colors[this.randomNum(0,this.colors.length)];else{var o=[];switch(this.bgColor.trim().length){case 4:var r=this.bgColor.substr(1,1);o.push(parseInt(r+=r,16));var i=this.bgColor.substr(2,1);o.push(parseInt(i+=i,16));var a=this.bgColor.substr(3,1);o.push(parseInt(a+=a,16));break;case 7:o.push(parseInt(this.bgColor.substr(1,2),16)),o.push(parseInt(this.bgColor.substr(3,2),16)),o.push(parseInt(this.bgColor.substr(5,2),16));break;case 11:o=[1e3,1e3,1e3];default:o=this.bgColor.replace(/rgb\(|\)|rgba\(/g,"").split(",")}t.replace(/rgb\(|\)|rgba\(/g,"").split(",").map(function(t,r){Math.abs(t-o[r])>80&&e++})}return e>1?t:this.calcColor()},valid:function(t){return t.toLocaleLowerCase()===this.captchaCode.toLocaleLowerCase()},drawLine:function(){for(var t=this.ctx,e=0;e<this.lineNumber;e++){t.beginPath(),t.shadowColor=this.randomRgbaColor(this.lineColorMin,this.lineColorMax,this.lineColorOpacity),t.shadowBlur=this.randomNum(0,this.lineFuzzy),t.shadowOffsetY=2*this.height,t.lineWidth=this.randomNum(2,this.lineWidth);var o=this.randomNum(0,this.width),r=this.randomNum(0,this.height)-2*this.height;t.moveTo(o,r);var i=this.randomNum(0,this.width),a=this.randomNum(0,this.height)-2*this.height;t.lineTo(i,a),t.stroke()}},drawDot:function(){for(var t=this.ctx,e=0;e<this.dotNumber;e++){t.shadowColor=this.randomRgbaColor(this.dotColorMin,this.dotColorMax,this.dotColorOpacity),t.shadowBlur=this.randomNum(0,this.dotFuzzy),t.shadowOffsetY=2*this.height,t.beginPath();var o=this.randomNum(0,this.width),r=this.randomNum(0,this.height)-2*this.height;t.arc(o,r,this.randomNum(1,this.dotR),0,2*Math.PI),t.fill()}}}}}])});
//# sourceMappingURL=rudy-captcha.js.map